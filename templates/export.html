{% extends "base.html" %}
{% block title %}Exporter des données - Gestion de Prêts{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="page-title mb-0">
        <i class="bi bi-download text-primary"></i> Exporter des données
    </h1>
    <a href="{{ url_for('admin_dashboard') }}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Administration
    </a>
</div>

<p class="text-muted mb-4">
    Sélectionnez les données à exporter au format CSV (compatible Excel).
</p>

<div class="row g-4">
    <!-- Personnes -->
    <div class="col-12 col-md-6">
        <div class="card border-0 shadow-sm h-100">
            <div class="card-body d-flex flex-column">
                <div class="d-flex align-items-center mb-3">
                    <div class="rounded-circle bg-primary bg-opacity-10 p-3 me-3">
                        <i class="bi bi-people-fill text-primary fs-4"></i>
                    </div>
                    <div>
                        <h5 class="mb-0">Personnes</h5>
                        <span class="text-muted small">{{ counts.personnes }} personne{{ 's' if counts.personnes != 1 }} active{{ 's' if counts.personnes != 1 }}</span>
                    </div>
                </div>
                <p class="text-muted small flex-grow-1">
                    Liste de toutes les personnes actives (nom, prénom, catégorie, classe).
                </p>
                <a href="{{ url_for('export_personnes') }}" class="btn btn-outline-primary w-100 {{ 'disabled' if counts.personnes == 0 }}">
                    <i class="bi bi-download"></i> Télécharger
                </a>
            </div>
        </div>
    </div>

    <!-- Prêts en cours -->
    <div class="col-12 col-md-6">
        <div class="card border-0 shadow-sm h-100">
            <div class="card-body d-flex flex-column">
                <div class="d-flex align-items-center mb-3">
                    <div class="rounded-circle bg-warning bg-opacity-10 p-3 me-3">
                        <i class="bi bi-hourglass-split text-warning fs-4"></i>
                    </div>
                    <div>
                        <h5 class="mb-0">Prêts en cours</h5>
                        <span class="text-muted small">{{ counts.prets_en_cours }} prêt{{ 's' if counts.prets_en_cours != 1 }} non retourné{{ 's' if counts.prets_en_cours != 1 }}</span>
                    </div>
                </div>
                <p class="text-muted small flex-grow-1">
                    Tous les prêts actuellement en cours (non retournés).
                </p>
                <a href="{{ url_for('export_prets_en_cours') }}" class="btn btn-outline-warning w-100 {{ 'disabled' if counts.prets_en_cours == 0 }}">
                    <i class="bi bi-download"></i> Télécharger
                </a>
            </div>
        </div>
    </div>

    <!-- Alertes -->
    <div class="col-12 col-md-6">
        <div class="card border-0 shadow-sm h-100">
            <div class="card-body d-flex flex-column">
                <div class="d-flex align-items-center mb-3">
                    <div class="rounded-circle bg-danger bg-opacity-10 p-3 me-3">
                        <i class="bi bi-exclamation-triangle-fill text-danger fs-4"></i>
                    </div>
                    <div>
                        <h5 class="mb-0">Alertes (dépassements)</h5>
                        <span class="text-muted small">{{ counts.alertes }} prêt{{ 's' if counts.alertes != 1 }} en dépassement</span>
                    </div>
                </div>
                <p class="text-muted small flex-grow-1">
                    Prêts ayant dépassé la durée prévue (avec le temps de dépassement).
                </p>
                <a href="{{ url_for('export_alertes') }}" class="btn btn-outline-danger w-100 {{ 'disabled' if counts.alertes == 0 }}">
                    <i class="bi bi-download"></i> Télécharger
                </a>
            </div>
        </div>
    </div>

    <!-- Historique complet -->
    <div class="col-12 col-md-6">
        <div class="card border-0 shadow-sm h-100">
            <div class="card-body d-flex flex-column">
                <div class="d-flex align-items-center mb-3">
                    <div class="rounded-circle bg-success bg-opacity-10 p-3 me-3">
                        <i class="bi bi-clock-history text-success fs-4"></i>
                    </div>
                    <div>
                        <h5 class="mb-0">Historique des prêts</h5>
                        <span class="text-muted small">{{ counts.historique }} prêt{{ 's' if counts.historique != 1 }} au total</span>
                    </div>
                </div>
                <p class="text-muted small flex-grow-1">
                    Historique complet de tous les prêts (en cours + retournés).
                </p>
                <a href="{{ url_for('export_prets') }}" class="btn btn-outline-success w-100 {{ 'disabled' if counts.historique == 0 }}">
                    <i class="bi bi-download"></i> Télécharger
                </a>
            </div>
        </div>
    </div>

    <!-- Inventaire -->
    <div class="col-12 col-md-6">
        <div class="card border-0 shadow-sm h-100">
            <div class="card-body d-flex flex-column">
                <div class="d-flex align-items-center mb-3">
                    <div class="rounded-circle bg-info bg-opacity-10 p-3 me-3">
                        <i class="bi bi-pc-display text-info fs-4"></i>
                    </div>
                    <div>
                        <h5 class="mb-0">Inventaire matériel</h5>
                        <span class="text-muted small">{{ counts.inventaire }} matériel{{ 's' if counts.inventaire != 1 }} inventorié{{ 's' if counts.inventaire != 1 }}</span>
                    </div>
                </div>
                <p class="text-muted small flex-grow-1">
                    Liste complète du parc matériel (type, marque, modèle, n° série, n° inventaire, etc.).
                </p>
                <a href="{{ url_for('export_inventaire') }}" class="btn btn-outline-info w-100 {{ 'disabled' if counts.inventaire == 0 }}">
                    <i class="bi bi-download"></i> Télécharger
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
